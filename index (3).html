<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CCM Notebooks ‚Äî Dashboard</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg: #eaf2ff;
      --card: #ffffff;
      --muted: #475569;
      --primary: #0b6ef6; /* azul predominante */
      --accent: #06b981;  /* detalhes em verde */
      --success: #10b981;
      --danger: #ef4444;
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 8px 28px rgba(9,30,66,0.08);
      --radius: 12px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#eaf2ff 0%, #f8fcff 100%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Layout */
    .app {
      display:flex;
      min-height:100vh;
      gap:24px;
      padding:28px;
    }
    aside.sidebar {
      width:300px;
      background:linear-gradient(180deg,#063a77,var(--primary));
      color:white;
      border-radius:16px;
      padding:20px;
      box-shadow: 0 12px 40px rgba(6,33,82,0.14);
      flex-shrink:0;
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      text-align:center;
    }

    .brand {
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:6px;
      flex-direction:column;
      width:100%;
    }
    .logo {
      width:86px;height:86px;border-radius:14px;
      background:linear-gradient(135deg,#a78bfa,#60a5fa);
      display:flex;align-items:center;justify-content:center;
      box-shadow: 0 6px 18px rgba(99,102,241,0.12);
      font-weight:700;color:white;overflow:hidden;
    }
    .logo img{width:100%;height:100%;object-fit:contain;display:block}

    .brand h1{font-size:18px;margin:6px 0 0;font-weight:800}
    .brand p{font-size:12px;margin:0;opacity:0.95}

    nav.side-nav{display:flex;flex-direction:column;gap:8px;margin-top:8px;width:100%}
    nav.side-nav button{
      background:transparent;border:0;color:white;padding:12px 14px;border-radius:10px;text-align:left;
      display:flex;gap:12px;align-items:center;font-weight:700;cursor:pointer;
      transition:background .18s, transform .08s;width:100%;
    }
    nav.side-nav button svg {opacity:0.95}
    nav.side-nav button:hover{background: rgba(255,255,255,0.06); transform:translateY(-1px)}
    nav.side-nav button.active{background: rgba(255,255,255,0.12)}

    main.content {
      flex:1;
      display:flex;
      flex-direction:column;
      gap:18px;
    }

    .topbar {
      display:flex;justify-content:space-between;align-items:center;gap:12px;
    }

    .searchbar {
      display:flex;gap:8px;align-items:center;
      background:var(--card);padding:8px 10px;border-radius:12px;box-shadow:var(--shadow);
    }
    .searchbar input{
      border:0;outline:0;font-size:14px;padding:8px;background:transparent;width:360px;
    }

    .cards {
      display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;
    }

    .card {
      background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--shadow);
    }
    .card h3{margin:0;font-size:13px;color:var(--muted);font-weight:600}
    .card p{margin:8px 0 0;font-size:22px;font-weight:700}

    .panel {
      background:var(--card);border-radius:12px;padding:16px;box-shadow:var(--shadow);
    }

    /* table */
    table {
      width:100%;border-collapse:collapse;font-size:14px;
    }
    thead th{
      text-align:left;padding:12px 10px;border-bottom:1px solid #eef6ff;color:var(--muted);
    }
    tbody td{
      padding:12px 10px;border-bottom:1px solid #f1f5f9;
      vertical-align:middle;
    }
    tr:hover td{background:#fbfdff}

    .badge {
      display:inline-block;padding:6px 10px;border-radius:999px;font-weight:600;font-size:12px;
    }
    .badge.disp{background:#ecfeff;color:#03545b}
    .badge.uso{background:#ffedd5;color:#92400e}
    .badge.dev{background:#ecfdf5;color:#065f46}
    .badge.indis{background:#fff1f2;color:#7f1d1d;border:1px solid rgba(239,68,68,0.08)}
    .badge.resv{background:#fff7ed;color:#92400e;border:1px solid rgba(245,158,11,0.08)}

    /* Buttons */
    .btn {
      display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:8px;border:0;cursor:pointer;
      font-weight:700;
    }
    .btn.primary{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;box-shadow:0 8px 24px rgba(11,110,246,0.12)}
    .btn.ghost{background:#6ea3ee;border:1px solid rgba(255,255,255,0.12);color:rgb(44, 50, 126);padding:8px 12px}
    .btn.warn{background:var(--accent);color:white}
    .btn.danger{background:var(--danger);color:white}

    .actions {display:flex;gap:8px;justify-content:flex-end}

    /* grid panels for main area */
    .grid-2 {display:grid;grid-template-columns:1fr 420px;gap:16px;align-items:start}
    .charts {display:flex;flex-direction:column;gap:12px}

    /* responsive */
    @media (max-width:1000px){ .app{padding:16px}.sidebar{display:none} .grid-2{grid-template-columns:1fr} .searchbar input{width:140px} }

    /* toast */
    #toast-container {
      position:fixed;right:20px;bottom:20px;display:flex;flex-direction:column;gap:8px;z-index:9999;
    }
    .toast {
      background:#111827;color:white;padding:10px 14px;border-radius:8px;box-shadow:0 8px 24px rgba(2,6,23,0.4);
      font-weight:600;font-size:14px;opacity:0;transform:translateY(8px);transition:opacity .18s,transform .18s;
    }
    .toast.show{opacity:1;transform:none}

    /* small helpers */
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:12px}
    .table-scroll{max-height:360px;overflow:auto;border-radius:8px}
    .filters{display:flex;gap:8px;align-items:center}
    .select, select, input[type="text"], input[type="date"], input[type="number"]{padding:8px;border-radius:8px;border:1px solid #e6eefc;background:white;outline:none}
    .chip{background:#2869aa;padding:6px 10px;border-radius:999px;font-weight:600}

    /* Empr√©stimos - selection helpers */
    .nb-card {
      justify-content:flex-start;border:1px solid #eef7ff;border-radius:10px;padding:10px;display:flex;gap:8px;align-items:center;
      background:linear-gradient(180deg,#fff,#fbfffe);
    }
    .nb-card.disabled{opacity:0.55;cursor:not-allowed}
    .nb-card .initial {
      min-width:46px;min-height:36px;border-radius:8px;background:#f0f9ff;display:flex;align-items:center;justify-content:center;font-weight:700;
    }

    /* Modal simple */
    .modal {
      position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.45);z-index:1200;
    }
    .modal .box {
      width:520px;background:var(--card);padding:18px;border-radius:12px;box-shadow:var(--shadow);
    }
  </style>
</head>
<body>
  
  <div id="loginTela" style="
  display:none;
  height:100vh;
  width:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#f1f5f9;">
  
  <div style="
    width:330px;
    background:white;
    padding:24px;
    border-radius:12px;
    box-shadow:0 4px 14px rgba(0,0,0,0.15);">
    
    <h2 style="margin:0 0 12px;">Login</h2>

    <input id="emailLogin" placeholder="Email" style="width:100%; margin-bottom:8px;">
    <input id="senhaLogin" type="password" placeholder="Senha" style="width:100%; margin-bottom:12px;">

    <button class="btn primary" style="width:100%;" onclick="fazerLogin()">Entrar</button>

    <p class="small muted" style="text-align:center; margin:12px 0;">ou</p>

    <button class="btn ghost" style="width:100%;" onclick="abrirCadastro()">Criar nova conta</button>

  </div>
</div>

<div id="cadastroTela" style="
  display:none;
  height:100vh;
  width:100%;
  align-items:center;
  justify-content:center;
  background:#f1f5f9;">
  
  <div style="
    width:330px;
    background:white;
    padding:24px;
    border-radius:12px;
    box-shadow:0 4px 14px rgba(0,0,0,0.15);">

    <h2 style="margin:0 0 12px;">Criar Conta</h2>

    <input id="nomeCadastro" placeholder="Nome completo" style="width:100%; margin-bottom:8px;">
    <input id="emailCadastro" placeholder="Email" style="width:100%; margin-bottom:8px;">
    <input id="senhaCadastro" type="password" placeholder="Senha" style="width:100%; margin-bottom:12px;">

    <button class="btn primary" style="width:100%;" onclick="criarConta()">Cadastrar</button>

    <p class="small muted" style="text-align:center; margin:12px 0;">ou</p>

    <button class="btn ghost" style="width:100%;" onclick="abrirLogin()">Voltar ao login</button>

  </div>
</div>


  
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar" role="navigation">
      <div class="brand">
        <div class="logo" title="Logo CCM">
          <!-- PUT logo.png in same folder (recommended) -->
          <img src="https://www.educacao.pr.gov.br/sites/default/arquivos_restritos/files/imagem/2022-03/brasao_cpmpr270.png" alt="Logo CCM" onerror="this.style.display='none'"/>
        </div>
        <div style="width:100%">
          <h1>CCM Notebooks</h1>
          <p class="small">Painel administrativo</p>
        </div>
      </div>

      <nav class="side-nav" aria-label="Main">
        <button class="active" data-page="home" onclick="navTo(event,'home')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M3 11.5L12 4l9 7.5" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Home
        </button>

        <button data-page="notebooks" onclick="navTo(event,'notebooks')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="1.4"/></svg>
          Notebooks
        </button>

        <button data-page="alunos" onclick="navTo(event,'alunos')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="8" r="3" stroke="currentColor" stroke-width="1.4"/><path d="M6 20c1.5-3 9-3 12 0" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Alunos
        </button>

        <button data-page="professores" onclick="navTo(event,'professores')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2v6" stroke="currentColor" stroke-width="1.4"/><rect x="6" y="8" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.4"/></svg>
          Professores
        </button>

        <button data-page="emprestimos" onclick="navTo(event,'emprestimos')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 7h18M7 7v10" stroke="currentColor" stroke-width="1.4"/></svg>
          Empr√©stimos
        </button>

        <button data-page="reservas" onclick="navTo(event,'reservas')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.4"/><path d="M16 2v4" stroke="currentColor" stroke-width="1.4"/></svg>
          Reservas
        </button>

        <button data-page="relatorio" onclick="navTo(event,'relatorio')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 3v18h18" stroke="currentColor" stroke-width="1.4"/></svg>
          Relat√≥rio
        </button>

        <button data-page="config" onclick="navTo(event,'config')">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 15.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z" stroke="currentColor" stroke-width="1.4"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 11-4 0v-.09a1.65 1.65 0 00-1-1.51 1.65 1.65 0 00-1.82.33l-.06.06A2 2 0 013 17.88l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 110-4h.09a1.65 1.65 0 001.51-1 1.65 1.65 0 00-.33-1.82L4.21 3.21A2 2 0 016 0.38l.06.06a1.65 1.65 0 001.82.33h0A1.65 1.65 0 0010 1.25V1a2 2 0 114 0v.25a1.65 1.65 0 001 .51 1.65 1.65 0 001.82-.33l.06-.06A2 2 0 0120.12 3l-.06.06a1.65 1.65 0 00-.33 1.82 1.65 1.65 0 001.51 1H21a2 2 0 110 4h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="1.4"/></svg>
          Configura√ß√µes
        </button>
      </nav>

      <div style="margin-top:auto;width:100%;">
        <div class="small muted">Vers√£o</div>
        <div class="chip small" style="margin-top:8px">v1.3 ‚Äî CCM</div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="content">
      <div class="topbar" 
      style="display:flex; align-items:center; justify-content:space-between; 
             padding:14px 18px; background:#ffffff; border-radius:12px;
             box-shadow:0 4px 14px rgba(13, 23, 55, 0.06);">
 
   <div style="font-size:15px; font-weight:500; color:#475569;">
     Desenvolvido por 2¬∞ Desenvolvimento de Sistemas! 
   </div>
 
   <div style="display:flex; gap:12px;">
     <button class="btn ghost" style="padding:8px 16px; border-radius:10px;">Backup</button>
 
     <button class="btn primary" style="padding:8px 16px; border-radius:10px;"
             onclick="abrirModalEmprestar()">
       Novo Empr√©stimo
     </button>
   </div>
 
 </div> 

      <!-- Dashboard / container -->
      <section id="conteudo"></section>
    </main>
  </div>

  <!-- Modal: Emprestar Selecionados -->
  <div id="modalEmprestar" class="modal" aria-hidden="true">
    <div class="modal-content">
  
      <h3>Emprestar dispositivos selecionados</h3>
  
      <!-- Tipo -->
      <select id="modalTipo" class="select" onchange="atualizarListaResponsaveis()">
        <option value="aluno">Aluno</option>
        <option value="professor">Professor</option>
      </select>
  
      <!-- Lista din√¢mica -->
      <select id="modalNome" class="select">
        <option value="">Selecione o aluno</option>
      </select>
  
      <!-- Data -->
      <input id="modalData" type="date" class="select" />
  
      <!-- Bot√µes -->
      <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px;">
        <button class="btn ghost" onclick="fecharModalEmprestar()">Cancelar</button>
        <button class="btn primary" onclick="confirmarEmprestimoSelecionados()">Confirmar</button>
      </div>
  
    </div>
  </div>  

  <!-- Modal: Reservar (opcional confirm) -->
  <div id="modalReservar" class="modal" aria-hidden="true">
    <div class="box">
      <h3 style="margin-top:0">Confirmar Reserva</h3>
      <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:8px">
        <div style="display:flex;gap:8px">
          <input id="dataReserva" type="date" class="select" />
            <option value="Segunda">Segunda</option>
            <option value="Ter√ßa">Ter√ßa</option>
            <option value="Quarta">Quarta</option>
            <option value="Quinta">Quinta</option>
            <option value="Sexta">Sexta</option>
          </select>
          <select id="resSlot" class="select">
            <option value="7:00-7:50">7:00-7:50</option>
            <option value="7:50-8:40">7:50-8:40</option>
            <option value="8:40-9:30">8:40-9:30</option>
            <option value="9:45-10:35">9:45-10:35</option>
            <option value="10:35-11:25">10:35-11:25</option>
            <option value="11:25-12:15">11:25-12:15</option>
          </select>
        </div>
        <input id="resProfessor" placeholder="Nome do professor (ex: Prof. Ana)" />
        <div id="resSelectedCount" class="small muted">Selecionados: 0</div>
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn ghost" onclick="fecharModalReservar()">Cancelar</button>
        <button class="btn primary" onclick="confirmarReservasSelecionadas()">Confirmar Reserva</button>
      </div>
    </div>
  </div>

  <!-- Toast container -->
  <div id="toast-container" aria-live="polite"></div>

  <script>

// --- SISTEMA DE LOGIN ---

function abrirLogin(){
  document.getElementById("loginTela").style.display = "flex";
  document.getElementById("cadastroTela").style.display = "none";
  // garante que o app N√ÉO fique acess√≠vel/vis√≠vel
  const app = document.getElementById("app");
  if (app) app.style.display = "none";
  // bloqueia scroll do body (impede arrastar/scroll para ver o app)
  document.body.style.overflow = "hidden";
}

/* mostra o overlay de cadastro e bloqueia o scroll/uso da app */
function abrirCadastro(){
  document.getElementById("loginTela").style.display = "none";
  document.getElementById("cadastroTela").style.display = "flex";
  const app = document.getElementById("app");
  if (app) app.style.display = "none";
  document.body.style.overflow = "hidden";
}

/* exibe o app quando o login for bem sucedido */
function carregarApp(){
  // restaura o comportamento do body
  document.body.style.overflow = "";
  // mostra app e esconde overlays
  const app = document.getElementById("app");
  if (app) app.style.display = "flex";
  document.getElementById("loginTela").style.display = "none";
  document.getElementById("cadastroTela").style.display = "none";

  // mostra bot√£o sair (se existir)
  const btnSair = document.getElementById("btnLogout");
  if (btnSair) btnSair.style.display = "inline-flex";

  // renderiza a p√°gina inicial (ajuste se seu app usar outra fun√ß√£o)
  if (typeof mostrarPagina === "function") mostrarPagina('home');
}

/* Faz o login: se der certo, abre o app (carregarApp) */
function fazerLogin(){
  const email = document.getElementById("emailLogin").value.trim();
  const senha = document.getElementById("senhaLogin").value.trim();

  const usuarios = JSON.parse(localStorage.getItem("usuarios") || "[]");
  const usuario = usuarios.find(u => u.email === email && u.senha === senha);

  if(!usuario){
    return showToast("Email ou senha incorretos.", "danger");
  }

  localStorage.setItem("usuarioAtual", JSON.stringify(usuario));

  showToast("Login realizado com sucesso!", "success");

  // abre o app imediatamente
  carregarApp();
}

/* cria conta e retorna para tela de login */
function criarConta(){
  const nome = document.getElementById("nomeCadastro").value.trim();
  const email = document.getElementById("emailCadastro").value.trim();
  const senha = document.getElementById("senhaCadastro").value.trim();

  if(!nome || !email || !senha){
    return showToast("Preencha todos os campos.", "danger");
  }

  const usuarios = JSON.parse(localStorage.getItem("usuarios") || "[]");

  if(usuarios.some(u => u.email === email)){
    return showToast("Este email j√° est√° cadastrado.", "danger");
  }

  usuarios.push({ nome, email, senha });
  localStorage.setItem("usuarios", JSON.stringify(usuarios));

  showToast("Conta criada com sucesso! Fa√ßa login.", "success");
  abrirLogin();
}

/* logout: esconde app e volta para login, bloqueando scroll */
function logout() {
  // remove o usu√°rio logado
  localStorage.removeItem("usuarioAtual");

  // limpa campos do login
  document.getElementById("emailLogin").value = "";
  document.getElementById("senhaLogin").value = "";
  document.getElementById("nomeCadastro").value = "";
  document.getElementById("emailCadastro").value = "";
  document.getElementById("senhaCadastro").value = "";

  // volta para a tela de login
  abrirLogin();

  // esconde o app
  document.getElementById("app").style.display = "none";

  showToast("Voc√™ saiu da conta!", "primary");
}


/* chamada de inicializa√ß√£o: verifica sess√£o ao carregar a p√°gina */
document.addEventListener('DOMContentLoaded', () => {
  const usuario = JSON.parse(localStorage.getItem("usuarioAtual") || "null");
  if (usuario) {
    // usu√°rio j√° logado: garante app vis√≠vel
    carregarApp();
  } else {
    // sem login: mostra login e bloqueia app
    abrirLogin();
  }
});


  // Exibe o app
  document.getElementById("app").style.display = "flex";
  document.getElementById("loginTela").style.display = "none";
  document.getElementById("cadastroTela").style.display = "none";

  renderPage("alunos"); // P√°gina inicial




    // ---------- Helper UI / Toast ----------
    function showToast(msg, type = "info", ttl = 2500) {
      const c = document.getElementById('toast-container');
      const el = document.createElement('div');
      el.className = 'toast';
      el.textContent = msg;
      if (type === 'success') el.style.background = '#065f46';
      if (type === 'danger') el.style.background = '#991b1b';
      c.appendChild(el);
      requestAnimationFrame(() => el.classList.add('show'));
      setTimeout(() => {
        el.classList.remove('show');
        setTimeout(()=>el.remove(), 220);
      }, ttl);
    }

    // ---------- Navigation ----------
    function navTo(evt, page) {
      document.querySelectorAll('.side-nav button').forEach(b => b.classList.remove('active'));
      if (evt && evt.currentTarget) evt.currentTarget.classList.add('active');
      mostrarPagina(page);
    }

    // ---------- Init ----------
    document.addEventListener('DOMContentLoaded', () => {
      inicializarNotebooks();
      mostrarPagina('home');
    });

    // ---------- Storage initialization ----------
    function inicializarNotebooks() {
      let notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      if (notebooks.length === 0) {
        const novos = [];
        for (let i = 1; i <= 20; i++) novos.push({ id: `V-${i}`, marca: "VAIO", tipo: "Notebook", status: "Dispon√≠vel" });
        for (let i = 1; i <= 35; i++) novos.push({ id: `TS-${i}`, marca: "Samsung", tipo: "Tablet", status: "Dispon√≠vel" });
        for (let i = 1; i <= 10; i++) novos.push({ id: `CS-${i}`, marca: "Samsung", tipo: "Chromebook", status: "Dispon√≠vel" });
        for (let i = 1; i <= 20; i++) novos.push({ id: `P-${i}`, marca: "Positivo", tipo: "Notebook", status: "Dispon√≠vel" });
        localStorage.setItem('notebooks', JSON.stringify(novos));
      }
      if (!localStorage.getItem('emprestimos')) localStorage.setItem('emprestimos', JSON.stringify([]));
      if (!localStorage.getItem('alunos')) localStorage.setItem('alunos', JSON.stringify([]));
      if (!localStorage.getItem('professores')) localStorage.setItem('professores', JSON.stringify([]));
      if (!localStorage.getItem('reservas')) localStorage.setItem('reservas', JSON.stringify([]));
    }

    // ---------- Page router ----------
    function mostrarPagina(pagina) {
      const conteudo = document.getElementById('conteudo');
      switch (pagina) {
        case 'home': renderHome(conteudo); break;
        case 'notebooks': renderNotebooks(conteudo); break;
        case 'alunos': renderAlunos(conteudo); break;
        case 'professores': renderProfessores(conteudo); break;
        case 'emprestimos': renderEmprestimos(conteudo); break;
        case 'reservas': renderReservas(conteudo); break;
        case 'relatorio': renderRelatorio(conteudo); break;
        case 'config': renderConfig(conteudo); break;
        default: renderHome(conteudo);
      }
      // ensure active button matches
      document.querySelectorAll('.side-nav button').forEach(b => {
        if (b.dataset.page === pagina) {
          b.classList.add('active');
        }
      });
    }

    // ---------- HOME (dashboard) ----------
    function renderHome(div) {
      div.innerHTML = `
        <div class="grid-2">
          <div>
            <div class="cards">
              <div class="card">
                <h3>Notebooks & Tablets</h3>
                <p id="cardNotebooks">‚Äî</p>
                <div class="muted small">Dispon√≠veis / Em uso</div>
              </div>
              <div class="card">
                <h3>Usu√°rios cadastrados</h3>
                <p id="cardUsuarios">‚Äî</p>
                <div class="muted small">Alunos / Professores</div>
              </div>
              <div class="card">
                <h3>Empr√©stimos</h3>
                <p id="cardEmprestimos">‚Äî</p>
                <div class="muted small">Ativos / Total</div>
              </div>
            </div>

            <div class="panel" style="margin-top:16px">
              <h3 style="margin:0 0 10px">Gr√°ficos</h3>
              <div style="display:flex;gap:12px;flex-wrap:wrap">
                <div style="flex:1;min-width:240px" class="panel"><canvas id="chart1" height="140"></canvas></div>
                <div style="flex:1;min-width:240px" class="panel"><canvas id="chart2" height="140"></canvas></div>
              </div>
            </div>
          </div>

          <div class="panel">
            <h3 style="margin-top:0">√öltimos Empr√©stimos</h3>
            <div id="recentList" class="table-scroll"></div>
          </div>
        </div>
      `;
      atualizarHomeData();
    }

    function atualizarHomeData() {
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
      const professores = JSON.parse(localStorage.getItem('professores')) || [];
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];

      const emUso = emprestimos.filter(e => e.status.includes('Em uso') || e.status.includes('Emprestado')).length;
      const disponiveis = notebooks.filter(n => n.status === 'Dispon√≠vel').length;

      document.getElementById('cardNotebooks').textContent = `${disponiveis} / ${emUso}`;
      document.getElementById('cardUsuarios').textContent = `${alunos.length} / ${professores.length}`;
      document.getElementById('cardEmprestimos').textContent = `${emUso} / ${emprestimos.length}`;

      // recent list
      const recent = emprestimos.slice().reverse().slice(0,8);
      document.getElementById('recentList').innerHTML = recent.length ? `
        <table><thead><tr><th>Notebook</th><th>Respons√°vel</th><th>Status</th></tr></thead>
        <tbody>${recent.map(r=>`<tr><td>${r.id}</td><td>${r.alunoSel || r.profSel}</td><td>${r.status}</td></tr>`).join('')}</tbody></table>
      ` : '<div class="muted small">Nenhum empr√©stimo ainda.</div>';

      // charts
      renderCharts();
    }

    function renderCharts(){
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      const reservas = JSON.parse(localStorage.getItem('reservas')) || [];

      const cntDisp = notebooks.filter(n => n.status === 'Dispon√≠vel').length;
      const cntInd = notebooks.filter(n => n.status === 'Indispon√≠vel').length;
      const cntUso = notebooks.filter(n => n.status !== 'Dispon√≠vel' && n.status !== 'Indispon√≠vel').length;
      const ctx1 = document.getElementById('chart1').getContext('2d');
      if (window._chart1) window._chart1.destroy();
      window._chart1 = new Chart(ctx1, {
        type:'doughnut',
        data:{labels:['Dispon√≠vel','Indispon√≠vel','Em uso'],datasets:[{data:[cntDisp,cntInd,cntUso]}]},
        options:{plugins:{legend:{display:true},title:{display:true,text:'Status dos Dispositivos'}}}
      });

      const cntDev = emprestimos.filter(e=>e.status.includes('Devolvido')).length;
      const ctx2 = document.getElementById('chart2').getContext('2d');
      if (window._chart2) window._chart2.destroy();
      window._chart2 = new Chart(ctx2, {
        type:'pie',
        data:{labels:['Em uso','Devolvidos'],datasets:[{data:[emprestimos.filter(e=>e.status.includes('Em uso')||e.status.includes('Emprestado')).length,cntDev]}]},
        options:{plugins:{legend:{display:true},title:{display:true,text:'Empr√©stimos'}}}
      });
    }

    // ---------- NOTEBOOKS ----------
    function renderNotebooks(div){
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      div.innerHTML = `
        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
          <h2 style="margin:0">Notebooks & Tablets</h2>
          <div class="filters">
            <select id="filterDevice" class="select" onchange="renderNotebooks(document.getElementById('conteudo'))">
              <option value="Todos">Todos</option>
              <option value="Notebook">Notebook</option>
              <option value="Tablet">Tablet</option>
              <option value="Chromebook">Chromebook</option>
            </select>
            <input id="searchDevice" placeholder="Buscar ID ou marca..." oninput="renderNotebooks(document.getElementById('conteudo'))" />
          </div>
        </div>

        <div class="panel table-scroll" style="margin-top:12px">
          <table>
            <thead><tr><th>ID</th><th>Marca</th><th>Tipo</th><th>Status</th></tr></thead>
            <tbody>
              ${notebooks
                .filter(n=>{
                  const f = document.getElementById('filterDevice') ? document.getElementById('filterDevice').value : 'Todos';
                  if (f!=='Todos' && n.tipo !== f) return false;
                  const q = document.getElementById('searchDevice') ? document.getElementById('searchDevice').value.toLowerCase() : '';
                  if (!q) return true;
                  return n.id.toLowerCase().includes(q) || n.marca.toLowerCase().includes(q);
                })
                .map(n=>`<tr>
                  <td>${n.id}</td>
                  <td>${n.marca}</td>
                  <td>${n.tipo}</td>
                  <td>${statusBadge(n)}</td>
                </tr>`).join('')}
            </tbody>
          </table>
        </div>
      `;
    }

    // helper to render badges based on status
    function statusBadge(n){
      if (n.status === 'Dispon√≠vel') return '<span class="badge disp">Dispon√≠vel</span>';
      if (n.status === 'Indispon√≠vel') return '<span class="badge indis">Indispon√≠vel</span>';
      return `<span class="badge uso">${n.status}</span>`;
    }

    // ---------- ALUNOS ----------
    function renderAlunos(div){
  const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
  const busca = document.getElementById("searchAlunos")?.value.toLowerCase() || "";


  div.innerHTML = `
    <h2 style="margin:0 0 8px">Alunos</h2>

    <div style="display:flex; gap:12px; align-items:flex-start;">

      <!-- PAINEL 1: Cadastro -->
      <div style="flex:1" class="panel">
        <h4 style="margin:0 0 8px">Cadastrar aluno</h4>

        <div class="form-grid">
          <div>
            <input id="nomeAluno" placeholder="Nome completo" style="width:100%" />
          </div>
          <div>
            <input id="turmaAluno" placeholder="Turma (ex: 1A, 2B)" style="width:100%" />
          </div>
          <div>
            <input id="numeroAluno" placeholder="N√∫mero" type="number" style="width:100%" />
          </div>
          <div style="display:flex; gap:8px; align-items:center;">
            <button class="btn primary" onclick="adicionarAluno()">Adicionar</button>
            <button class="btn ghost" onclick="exportAlunosCSV()">Exportar CSV</button>
          </div>
        </div>

        <div style="margin-top:12px" class="muted small">
          Total de alunos: <span id="countAlunos">${alunos.length}</span>
        </div>
      </div>

      <!-- PAINEL 2: Lista -->
      <div style="flex:1" class="panel">
        <h4 style="margin:0 0 8px">Lista de alunos</h4>

        <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
          <input id="searchAlunos"
                 placeholder="Buscar por nome ou turma..."
                 oninput="renderAlunos(document.getElementById('conteudo'))"
                 style="flex:1; text-transform:none;" />
          <button class="btn ghost" onclick="renderAlunos(document.getElementById('conteudo'))">Buscar</button>
        </div>

        <div class="table-scroll">
          <table>
            <thead>
              <tr><th>Nome</th><th>Turma</th><th>N¬∫</th></tr>
            </thead>
            <tbody id="alunosBody">
              ${
                alunos.filter(a => {
  const q = busca.toLowerCase();

  if (!q) return true;

  return (
    a.nome.toLowerCase().includes(q) ||
    a.turma.toLowerCase().includes(q)
  );
})
                  .map(a => `
                    <tr>
                      <td>${a.nome}</td>
                      <td>${a.turma}</td>
                      <td>${a.numero}</td>
                    </tr>
                  `).join("")
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  `;

  document.getElementById("searchAlunos").value = busca;
  document.getElementById("searchAlunos").focus();


}


    function adicionarAluno(){
      const nome = document.getElementById('nomeAluno').value.trim();
      const turma = document.getElementById('turmaAluno').value.trim();
      const numero = document.getElementById('numeroAluno').value.trim();
      if (!nome || !turma || !numero) return showToast('Preencha todos os campos.', 'danger');

      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
      if (alunos.some(a => a.nome === nome && a.turma === turma)) {
        showToast('Esse aluno j√° est√° cadastrado.', 'danger'); return;
      }
      alunos.push({nome, turma, numero});
      localStorage.setItem('alunos', JSON.stringify(alunos));
      showToast('Aluno adicionado.', 'success');
      renderAlunos(document.getElementById('conteudo'));
    }

    // ---------- PROFESSORES ----------
    function renderProfessores(div){
  const professores = JSON.parse(localStorage.getItem('professores')) || [];

  div.innerHTML = `
    <h2 style="margin:0 0 8px">Professores</h2>

    <div style="display:flex; gap:12px; align-items:flex-start">

      <!-- PAINEL 1 ‚Äî Cadastro -->
      <div class="panel" style="flex:1">
        <h4 style="margin:0 0 8px">Cadastrar professor</h4>

        <div class="form-grid">

          <div>
            <input id="nomeProf" placeholder="Nome do professor" style="width:100%" />
          </div>

          <div>
            <input id="materiasProf" 
                   placeholder="Mat√©rias (separe por v√≠rgula)" 
                   class="tag-input"
                   style="width:100%" />
          </div>

          <div>
            <input id="turmasProf" 
                   placeholder="Turmas (ex: 1A, 2B, 3C)" 
                   class="tag-input"
                   style="width:100%" />
          </div>

          <div style="display:flex; gap:8px; align-items:center;">
            <button class="btn primary" onclick="adicionarProfessor()">Adicionar</button>
            <button class="btn ghost" onclick="exportProfCSV()">Exportar CSV</button>
          </div>

        </div>
      </div>


      <!-- PAINEL 2 ‚Äî Lista -->
      <div class="panel" style="flex:1">
        <h4 style="margin:0 0 8px">Lista de professores</h4>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th>Nome</th>
                <th>Mat√©rias</th>
                <th>Turmas</th>
              </tr>
            </thead>

            <tbody>
              ${
                professores.map(p => `
                  <tr>
                    <td>${p.nome}</td>
                    <td>${(p.materias || []).join(", ")}</td>
                    <td>${(p.turmas || []).join(", ")}</td>
                  </tr>
                `).join("")
              }
            </tbody>
          </table>
        </div>
      </div>

    </div>
  `;
}


function adicionarProfessor(){
  const nome = document.getElementById("nomeProf").value.trim();
  const materias = document.getElementById("materiasProf").value
    .split(",")
    .map(s => s.trim())
    .filter(Boolean);

  const turmas = document.getElementById("turmasProf").value
    .split(",")
    .map(s => s.trim())
    .filter(Boolean);

  if (!nome || !materias.length || !turmas.length) {
    return showToast("Preencha nome, mat√©rias e turmas.", "danger");
  }

  const professores = JSON.parse(localStorage.getItem("professores")) || [];

  if (professores.some(p => p.nome === nome)) {
    return showToast("Esse professor j√° est√° cadastrado.", "danger");
  }

  professores.push({ nome, materias, turmas });
  localStorage.setItem("professores", JSON.stringify(professores));

  showToast("Professor cadastrado com sucesso!", "success");
  renderProfessores(document.getElementById("conteudo"));
}


    // ---------- EMPR√âSTIMOS ----------
    function renderEmprestimos(div){
  const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
  const professores = JSON.parse(localStorage.getItem('professores')) || [];
  const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
  const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];

  // Salvar filtros antes da renderiza√ß√£o
  const filtroStatusSalvo = document.getElementById("filtroStatusEmp")?.value || "Todos";
  const filtroMarcaSalvo  = document.getElementById("filtroMarca")?.value || "Todos";
  const buscaSalva        = document.getElementById("searchEmp")?.value || "";

  // Marcas
  const marcas = Array.from(new Set(notebooks.map(n => n.marca))).sort();

  // --- AQUI CONTINUA NORMAL AT√â O FIM DO SEU div.innerHTML ---

  div.innerHTML = `
  
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h2 style="margin:0">Empr√©stimos</h2>

      <div style="display:flex; gap:8px; align-items:center;">
        <select id="filtroStatusEmp" class="select" onchange="renderEmprestimos(document.getElementById('conteudo'))">
          <option value="Todos">Todos</option>
          <option value="Em uso">Em uso</option>
          <option value="Devolvido">Devolvido</option>
        </select>

        <select id="filtroMarca" class="select" onchange="renderEmprestimos(document.getElementById('conteudo'))">
          <option value="Todos">Todas marcas</option>
          ${marcas.map(m => `<option value="${m}">${m}</option>`).join("")}
        </select>

        <input id="searchEmp"
       placeholder="Pesquisar..."
       oninput="renderEmprestimos(document.getElementById('conteudo'))"
       class="select"
       style="width:180px; text-transform:none;" />

      </div>
    </div>

    <div style="display:flex; gap:12px; margin-top:12px; flex-wrap:wrap;">

      <!-- PAINEL 1 -->
      <div style="flex:1; min-width:330px;" class="panel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
          <h4 style="margin:0">Novo Empr√©stimo</h4>

          <div>
            <button class="btn ghost" onclick="limparSelecao()">Limpar</button>
            <button class="btn primary" onclick="abrirModalEmprestar()">Emprestar Selecionados</button>
          </div>
        </div>

        <div style="margin-top:12px;">
          <h5 style="margin:0 0 8px">Selecionar dispositivos</h5>

          <div style="display:flex; align-items:center; gap:12px; margin-bottom:8px;">
            <label class="small muted">Filtrar por marca:</label>
            <select id="selMarcaFilter" class="select" onchange="filtrarGridByMarca()">
              <option value="Todos">Todas</option>
              ${marcas.map(m => `<option value="${m}">${m}</option>`).join("")}
            </select>
          </div>

          <div id="nbGrid"
               style="display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:8px;">
            ${notebooks.map(n => `
              <label class="nb-card ${n.status !== "Dispon√≠vel" ? "disabled" : ""}"
                     data-id="${n.id}" data-marca="${n.marca}">
                
                <input type="checkbox"
                       class="nb-checkbox"
                       data-id="${n.id}"
                       ${n.status !== "Dispon√≠vel" ? "disabled" : ""}
                       style="margin-right:8px;" />

                <div style="display:flex; gap:8px; align-items:center;">
                  <div class="initial">${n.marca[0]}</div>

                  <div>
                    <div style="font-weight:700">${n.id}</div>
                    <div class="small muted">${n.marca} ‚Ä¢ ${n.tipo}</div>
                    <div style="margin-top:6px">${statusBadge(n)}</div>
                  </div>
                </div>

              </label>
            `).join("")}
          </div>
        </div>
      </div>

      <!-- PAINEL 2 -->
      <div style="flex:1; min-width:420px;" class="panel">
        <h4 style="margin:0 0 8px">Lista de Empr√©stimos</h4>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Respons√°vel</th>
                <th>Status</th>
                <th>Marca</th>
                <th>Data</th>
                <th style="text-align:right">A√ß√µes</th>
              </tr>
            </thead>

            <tbody>
            
              ${
                emprestimos.filter(e => {
  // FILTRO STATUS
  if (filtroStatusSalvo !== "Todos" && e.status !== filtroStatusSalvo) return false;

  // BUSCAR MARCA REAL (se n√£o existir no empr√©stimo)
  const marcaReal = e.marca || (notebooks.find(n => n.id === e.id)?.marca) || "";

  // FILTRO MARCA
  if (filtroMarcaSalvo !== "Todos" && marcaReal !== filtroMarcaSalvo) return false;

  // BUSCA
  const q = buscaSalva.toLowerCase();
  if (!q) return true;

  return (
    e.id.toLowerCase().includes(q) ||
    (e.alunoSel || "").toLowerCase().includes(q) ||
    (e.profSel  || "").toLowerCase().includes(q)
  );
})
                  .map((e, i) => `
                    <tr>
                      <td>${e.id}</td>
                      <td>${e.alunoSel || e.profSel || "-"}</td>
                      <td>
                        ${
                          e.status === "Em uso" || e.status.includes("Emprestado")
                            ? `<span class="badge uso">Em uso</span>`
                            : `<span class="badge dev">Devolvido</span>`
                        }
                      </td>
                      <td>${e.marca || (notebooks.find(n => n.id === e.id)?.marca) || "-"}</td>
                      <td>${e.dataDevolucao || e.data || "-"}</td>

                      <td style="text-align:right">
                        ${
                          e.status === "Em uso"
                            ? `<button class="btn primary" onclick="devolverEmprestimo(${i})">Devolver</button>`
                            : `<button class="btn danger" onclick="excluirEmprestimo(${i})">Excluir</button>`
                        }
                      </td>
                    </tr>
                  `).join("")
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  `;

    // üî• Restaurar valores ap√≥s a renderiza√ß√£o
    document.getElementById("filtroStatusEmp").value = filtroStatusSalvo;
  document.getElementById("filtroMarca").value     = filtroMarcaSalvo;
  document.getElementById("searchEmp").value       = buscaSalva;

  // üî• Manter foco e permitir digita√ß√£o cont√≠nua
  const inp = document.getElementById("searchEmp");
  inp.focus();
  inp.setSelectionRange(buscaSalva.length, buscaSalva.length);
}

{
  // Atualiza eventos
  document.querySelectorAll(".nb-checkbox").forEach(cb => {
    cb.addEventListener("change", () => {});
  });
}

function filtrarGridByMarca(){
  const f = document.getElementById("selMarcaFilter").value;

  document.querySelectorAll("#nbGrid .nb-card").forEach(card => {
    const marca = card.getAttribute("data-marca");

    if (f === "Todos" || marca === f)
      card.style.display = "flex";
    else
      card.style.display = "none";
  });
}


function abrirModalEmprestar() {
  const selecionados = Array.from(document.querySelectorAll('.nb-checkbox:checked')).map(cb => cb.dataset.id);
  if (!selecionados.length) {
    showToast('Selecione ao menos um dispositivo.', 'danger');
    return;
  }

  document.getElementById("modalData").value = "";

  // carregar lista conforme o tipo atual
  atualizarListaResponsaveis();

  // abrir modal
  document.getElementById('modalEmprestar').style.display = 'flex';
  document.getElementById('modalEmprestar').setAttribute('aria-hidden', 'false');
}

{

  // Carregar listas
  const alunos = JSON.parse(localStorage.getItem('alunos')) || [];
  const professores = JSON.parse(localStorage.getItem('professores')) || [];

  const tipo = document.getElementById('modalTipo').value;
  const selectNome = document.getElementById('modalNome');

  // Limpar op√ß√µes antigas
  selectNome.innerHTML = "";

  // Preencher alunos
  if (tipo === "aluno") {
    selectNome.innerHTML = `<option value="">Selecione o aluno</option>`;
    alunos.forEach(a => {
      selectNome.innerHTML += `<option value="${a.nome}">${a.nome} (${a.turma})</option>`;
    });
  }

  // Preencher professores
  else if (tipo === "professor") {
    selectNome.innerHTML = `<option value="">Selecione o professor</option>`;
    professores.forEach(p => {
      selectNome.innerHTML += `<option value="${p.nome}">${p.nome}</option>`;
    });
  }

  // Abrir modal
  document.getElementById('modalData').value = "";
  document.getElementById('modalEmprestar').style.display = 'flex';
  document.getElementById('modalEmprestar').setAttribute('aria-hidden','false');
}


    function fecharModalEmprestar(){
      document.getElementById('modalEmprestar').style.display = 'none';
      document.getElementById('modalEmprestar').setAttribute('aria-hidden','true');
    }

    function confirmarEmprestimoSelecionados(){
      const tipo = document.getElementById('modalTipo').value;
      const nome = document.getElementById('modalNome').value;
      const data = document.getElementById('modalData').value;
      if (!nome) { showToast('Digite o nome do respons√°vel.', 'danger'); return; }

      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];

      const ids = Array.from(document.querySelectorAll('.nb-checkbox:checked')).map(cb => cb.dataset.id);

      const novos = ids.map(id => {
        const nb = notebooks.find(n=>n.id === id);
        if (nb) nb.status = `Emprestado ‚Äî ${nome}`;
        return { id, alunoSel: tipo==='aluno' ? nome : '', profSel: tipo==='professor' ? nome : '', status: 'Em uso', data: data || new Date().toLocaleString('pt-BR') };
      });

      emprestimos.push(...novos);
      localStorage.setItem('emprestimos', JSON.stringify(emprestimos));
      localStorage.setItem('notebooks', JSON.stringify(notebooks));

      fecharModalEmprestar();
      mostrarPagina('emprestimos');
      atualizarHomeData();
      showToast('Empr√©stimos registrados com sucesso.', 'success', 1800);
    }

    function devolverEmprestimo(index){
      let emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      if (!emprestimos[index]) return showToast('Empr√©stimo n√£o encontrado.', 'danger');
      if (emprestimos[index].status === 'Devolvido') return showToast('J√° foi devolvido.', 'danger');

      emprestimos[index].status = 'Devolvido';
      emprestimos[index].dataDevolucao = new Date().toLocaleString('pt-BR');

      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const nb = notebooks.find(n=>n.id === emprestimos[index].id);
      if (nb) nb.status = 'Dispon√≠vel';

      localStorage.setItem('emprestimos', JSON.stringify(emprestimos));
      localStorage.setItem('notebooks', JSON.stringify(notebooks));

      showToast('Empr√©stimo devolvido.', 'success');
      mostrarPagina('emprestimos');
      atualizarHomeData();
    }

    function excluirEmprestimo(index){
      if (!confirm('Excluir este empr√©stimo permanentemente?')) return;
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      emprestimos.splice(index,1);
      localStorage.setItem('emprestimos', JSON.stringify(emprestimos));
      showToast('Empr√©stimo exclu√≠do.', 'success');
      mostrarPagina('emprestimos');
      atualizarHomeData();
    }

    // ---------- RESERVAS ----------
    const SLOTS = ["7:00-7:50","7:50-8:40","8:40-9:30","9:45-10:35","10:35-11:25","11:25-12:15"];
    const DIAS = ["Segunda","Ter√ßa","Quarta","Quinta","Sexta"];

    function renderReservas(div){
  const professores = JSON.parse(localStorage.getItem('professores')) || [];
  const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
  const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];

  // total de equipamentos dispon√≠veis
  const maxEquip = notebooks.length;

  // hor√°rios dispon√≠veis
  const horarios = [
    "07:00 - 07:50",
    "07:50 - 08:40",
    "08:40 - 09:30",
    "09:45 - 10:35",
    "10:35 - 11:25",
    "11:25 - 12:15",
  ];

  div.innerHTML = `
    <h2 style="margin:0;">Reservas</h2>

    <div style="display:flex; gap:12px; margin-top:14px; align-items:flex-start;">

      <!-- PAINEL 1 ‚Äî NOVA RESERVA -->
      <div class="panel" style="flex:1;">
        <h4 style="margin:0 0 8px;">Nova reserva</h4>

        <div class="form-grid">
          
          <select id="profReserva" class="select">
            <option value="">Selecione o professor</option>
            ${professores.map(p => `<option value="${p.nome}">${p.nome}</option>`).join("")}
          </select>

          <!-- CALEND√ÅRIO -->
          <input id="dataReserva" type="date" class="select" />

          <select id="slotReserva" class="select">
            <option value="">Hor√°rio</option>
            ${horarios.map((h, i) => `<option value="${i}">${h}</option>`).join("")}
          </select>

          <!-- QUANTIDADE DIN√ÇMICA -->
          <input id="qtdReserva" type="number" class="select"
                 placeholder="Quantidade"
                 min="1" max="${maxEquip}" />

          <button class="btn primary" onclick="registrarReserva()">Registrar Reserva</button>
        </div>
      </div>

      <!-- PAINEL 2 ‚Äî LISTA RESERVAS -->
      <div class="panel" style="flex:1;">
        <h4 style="margin:0 0 8px;">Reservas registradas</h4>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th>Professor</th>
                <th>Data</th>
                <th>Hor√°rio</th>
                <th>Qtd</th>
                <th style="text-align:right;">A√ß√µes</th>
              </tr>
            </thead>

            <tbody>
              ${reservas.map((r, i) => `
                <tr>
                  <td>${r.prof}</td>
                  <td>${r.data || "-"}</td>
                  <td>${horarios[r.slot]}</td>
                  <td>${r.qtd}</td>
                  <td style="text-align:right;">
                    <button class="btn danger" onclick="removerReserva(${i})">Remover</button>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
      </div>

    </div>
  `;
}

function registrarReserva() {
  const prof = document.getElementById("profReserva").value;
  const data = document.getElementById("dataReserva").value;
  const slot = document.getElementById("slotReserva").value;
  const qtd = parseInt(document.getElementById("qtdReserva").value);

  if (!prof) return showToast("Selecione o professor.", "danger");
  if (!data) return showToast("Selecione uma data v√°lida.", "danger");
  if (slot === "") return showToast("Selecione o hor√°rio.", "danger");
  if (!qtd || qtd < 1) return showToast("Quantidade inv√°lida.", "danger");

  const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
  const maxEquip = notebooks.length;

  if (qtd > maxEquip) {
    return showToast(`M√°ximo permitido: ${maxEquip}`, "danger");
  }

  const reservas = JSON.parse(localStorage.getItem('reservas')) || [];

  reservas.push({ prof, data, slot, qtd });
  localStorage.setItem("reservas", JSON.stringify(reservas));

  showToast("Reserva registrada!", "success");
  mostrarPagina("reservas");
}

function removerReserva(i){
  const reservas = JSON.parse(localStorage.getItem("reservas")) || [];
  reservas.splice(i,1);
  localStorage.setItem("reservas", JSON.stringify(reservas));
  showToast("Reserva removida.", "success");
  renderReservas(document.getElementById("conteudo"));
}


    function limparSelecaoReservas(){
      document.querySelectorAll('.res-nb').forEach(cb => { cb.checked = false; cb.disabled = cb.getAttribute('data-original-disabled') === 'true' });
      showToast('Sele√ß√£o limpa.', 'info', 1200);
    }

    function atualizarDisponibilidadeNotebooksReservas(){
      const dia = document.getElementById('selDia').value;
      const slot = document.getElementById('selSlot').value;
      const reservas = JSON.parse(localStorage.getItem('reservas')) || [];

      // for each notebook checkbox: disable if already reserved at that dia+slot
      document.querySelectorAll('.res-nb').forEach(cb=>{
        const id = cb.dataset.id;
        const confl = reservas.some(r => r.dia === dia && r.slot === slot && r.notebooks.includes(id));
        // preserve original disabled state from status (Indispon√≠vel) by storing attribute
        if (!cb.hasAttribute('data-original-disabled')) {
          cb.setAttribute('data-original-disabled', cb.disabled ? 'true' : 'false');
        }
        cb.disabled = confl || (cb.getAttribute('data-original-disabled') === 'true');
        if (confl) cb.parentElement.style.opacity = '0.55';
        else cb.parentElement.style.opacity = '1';
      });
    }

    function abrirModalReservar(){
      const selecionados = Array.from(document.querySelectorAll('.res-nb:checked')).map(cb=>cb.dataset.id);
      if (!selecionados.length) { showToast('Selecione ao menos um notebook para reservar.', 'danger'); return; }
      const dia = document.getElementById('selDia').value;
      const slot = document.getElementById('selSlot').value;
      document.getElementById('resDia').value = dia;
      document.getElementById('resSlot').value = slot;
      document.getElementById('resProfessor').value = document.getElementById('selProf').value || '';
      document.getElementById('resSelectedCount').textContent = 'Selecionados: ' + selecionados.length;
      document.getElementById('modalReservar').style.display = 'flex';
      document.getElementById('modalReservar').setAttribute('aria-hidden','false');
    }

    function fecharModalReservar(){
      document.getElementById('modalReservar').style.display = 'none';
      document.getElementById('modalReservar').setAttribute('aria-hidden','true');
    }

    function confirmarReservasSelecionadas(){
      const selecionados = Array.from(document.querySelectorAll('.res-nb:checked')).map(cb=>cb.dataset.id);
      const dia = document.getElementById('resDia').value;
      const slot = document.getElementById('resSlot').value;
      const prof = document.getElementById('resProfessor').value.trim();
      if (!prof) { showToast('Digite o nome do professor.', 'danger'); return; }
      if (!selecionados.length) { showToast('Nenhum notebook selecionado.', 'danger'); return; }

      // check again if any conflict (race)
      const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
      const conflitantes = selecionados.filter(id => reservas.some(r => r.dia === dia && r.slot === slot && r.notebooks.includes(id)));
      if (conflitantes.length) {
        showToast('Um ou mais notebooks j√° foram reservados nesse hor√°rio: ' + conflitantes.join(', '), 'danger');
        atualizarDisponibilidadeNotebooksReservas();
        fecharModalReservar();
        return;
      }

      // create reserva
      reservas.push({
        id: 'R-' + Date.now(),
        professor: prof,
        dia,
        slot,
        notebooks: selecionados.slice(),
        createdAt: new Date().toISOString()
      });

      localStorage.setItem('reservas', JSON.stringify(reservas));
      fecharModalReservar();
      renderReservas(document.getElementById('conteudo'));
      showToast('Reserva criada.', 'success', 1400);
    }

    function cancelarReserva(index){
      if (!confirm('Cancelar esta reserva?')) return;
      const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
      reservas.splice(index,1);
      localStorage.setItem('reservas', JSON.stringify(reservas));
      renderReservas(document.getElementById('conteudo'));
      showToast('Reserva cancelada.', 'success');
    }

    function duplicarReserva(index){
      const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
      const base = reservas[index];
      if (!base) return;
      const nova = Object.assign({}, base, { id: 'R-'+Date.now(), createdAt: new Date().toISOString() });
      reservas.push(nova);
      localStorage.setItem('reservas', JSON.stringify(reservas));
      renderReservas(document.getElementById('conteudo'));
      showToast('Reserva duplicada.', 'success');
    }

    // ---------- RELAT√ìRIO ----------
    function renderRelatorio(div){
  const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
  const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];

  div.innerHTML = `
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <h2 style="margin:0;">Relat√≥rio Geral</h2>

      <button class="btn ghost" onclick="exportRelatorioCSV()">Exportar CSV</button>
    </div>

    <div class="panel" style="margin-top:14px;">
      <h4 style="margin:0 0 8px">Hist√≥rico de Empr√©stimos</h4>

      <div class="table-scroll">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Respons√°vel</th>
              <th>Marca</th>
              <th>Tipo</th>
              <th>Status</th>
              <th>Data Empr√©stimo</th>
              <th>Data Devolu√ß√£o</th>
            </tr>
          </thead>

          <tbody>
            ${
              emprestimos.map(e => {
                const device = notebooks.find(n => n.id === e.id) || {};
                return `
                  <tr>
                    <td>${e.id}</td>
                    <td>${e.alunoSel || e.profSel || "-"}</td>
                    <td>${device.marca || "-"}</td>
                    <td>${device.tipo || "-"}</td>

                    <td>
                      ${
                        e.status === "Em uso" || e.status.includes("Emprestado")
                          ? `<span class="badge uso">Em uso</span>`
                          : `<span class="badge dev">Devolvido</span>`
                      }
                    </td>

                    <td>${e.data || "-"}</td>
                    <td>${e.dataDevolucao || "-"}</td>
                  </tr>
                `;
              }).join("")
            }
          </tbody>
        </table>
      </div>
    </div>
  `;
}

function exportRelatorioCSV(){
  const emprestimos = JSON.parse(localStorage.getItem("emprestimos")) || [];
  const notebooks = JSON.parse(localStorage.getItem("notebooks")) || [];

  let csv = "ID;Respons√°vel;Marca;Tipo;Status;Data Empr√©stimo;Data Devolu√ß√£o\n";

  emprestimos.forEach(e => {
    const device = notebooks.find(n => n.id === e.id) || {};

    csv += [
      e.id,
      e.alunoSel || e.profSel || "-",
      device.marca || "-",
      device.tipo || "-",
      e.status,
      e.data || "-",
      e.dataDevolucao || "-"
    ].join(";") + "\n";
  });

  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "relatorio.csv";
  a.click();
}


    function filtrarRelatorio(){
      const filtro = document.getElementById('filtroRel').value;
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      const corpo = document.querySelector('#tableRel tbody');
      corpo.innerHTML = emprestimos
        .filter(e => filtro === 'Todos' || e.status === filtro)
        .map(e => `<tr>
          <td>${e.id}</td><td>${e.alunoSel}</td><td>${e.profSel}</td><td>${e.status}</td><td>${e.dataDevolucao || e.data || '-'}</td>
        </tr>`).join('');
    }

    // ---------- CONFIGURA√á√ïES (Manuten√ß√£o) ----------
    // ---------- CONFIGURA√á√ïES (Manuten√ß√£o) ----------
function renderConfig(div) {
  const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];

  div.innerHTML = `
    <h2 style="margin:0 0 12px;">Configura√ß√µes do Sistema</h2>

    <button class="btn danger" style="width:100%; margin-bottom:12px;" onclick="logout()">
      Sair da conta
    </button>

    <div style="display:grid; grid-template-columns: 1.3fr 0.7fr; gap:12px;">

      <!-- Painel 1 ‚Äî Dispositivos -->
      <div class="panel">
        <h4 style="margin:0 0 8px;">Manuten√ß√£o de Dispositivos</h4>
        <p class="muted small">Gerencie disponibilidade e exclus√£o.</p>

        <div class="table-scroll" style="margin-top:10px;">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Marca</th>
                <th>Tipo</th>
                <th>Status</th>
                <th style="text-align:right;">A√ß√µes</th>
              </tr>
            </thead>

            <tbody>
              ${
                notebooks.map(n => `
                  <tr>
                    <td>${n.id}</td>
                    <td>${n.marca}</td>
                    <td>${n.tipo}</td>
                    <td>${statusBadge(n)}</td>

                    <td style="text-align:right;">
                      ${
                        n.status === 'Indispon√≠vel'
                          ? `<button class="btn ghost" onclick="setDisponivel('${n.id}')">Marcar Dispon√≠vel</button>`
                          : `<button class="btn ghost" onclick="setIndisponivel('${n.id}')">Indispon√≠vel</button>`
                      }
                      <button class="btn danger" onclick="removerNotebook('${n.id}')">Remover</button>
                    </td>
                  </tr>
                `).join('')
              }
            </tbody>
          </table>
        </div>
      </div>

      <!-- Painel 2 ‚Äî A√ß√µes r√°pidas -->
      <div class="panel">
        <h4 style="margin:0 0 8px;">A√ß√µes R√°pidas</h4>
        <p class="muted small">Ferramentas √∫teis para manuten√ß√£o.</p>

        <div style="margin-top:12px; display:flex; flex-direction:column; gap:10px;">

          <button class="btn ghost" onclick="resetarDisponiveis()">
            Marcar todos como Dispon√≠veis
          </button>

          <button class="btn ghost" onclick="removerIndisponiveis()">
            Remover todos Indispon√≠veis
          </button>

          <button class="btn ghost" onclick="restaurarEquipamentosOriginais()">
            Restaurar invent√°rio original
          </button>

          <button class="btn ghost" onclick="backupDados()">
            Gerar Backup dos Dados
          </button>

          <button class="btn danger" onclick="limparSistema()">
            Resetar Sistema (apagar tudo)
          </button>

        </div>
      </div>

    </div>
  `;
}

// ---------- RESTAURAR INVENT√ÅRIO ORIGINAL ----------
function restaurarEquipamentosOriginais() {
  const novos = [];

  // 20 Notebooks VAIO
  for (let i = 1; i <= 20; i++) {
    novos.push({ id: `V-${i}`, marca: "VAIO", tipo: "Notebook", status: "Dispon√≠vel" });
  }

  // 35 Tablets Samsung
  for (let i = 1; i <= 35; i++) {
    novos.push({ id: `TS-${i}`, marca: "Samsung", tipo: "Tablet", status: "Dispon√≠vel" });
  }

  // 10 Chromebooks Samsung
  for (let i = 1; i <= 10; i++) {
    novos.push({ id: `CS-${i}`, marca: "Samsung", tipo: "Chromebook", status: "Dispon√≠vel" });
  }

  // 20 Notebooks Positivo
  for (let i = 1; i <= 20; i++) {
    novos.push({ id: `P-${i}`, marca: "Positivo", tipo: "Notebook", status: "Dispon√≠vel" });
  }

  // Salvar no localStorage
  localStorage.setItem("notebooks", JSON.stringify(novos));

  showToast("Invent√°rio original restaurado com sucesso!", "success");

  // Atualizar tela ap√≥s restaurar
  const conteudo = document.getElementById("conteudo");
  if (conteudo && typeof renderConfig === "function") {
    renderConfig(conteudo);
  }
}


function backupDados(){
  const dados = {
    alunos: JSON.parse(localStorage.getItem("alunos") || "[]"),
    professores: JSON.parse(localStorage.getItem("professores") || "[]"),
    notebooks: JSON.parse(localStorage.getItem("notebooks") || "[]"),
    emprestimos: JSON.parse(localStorage.getItem("emprestimos") || "[]"),
    reservas: JSON.parse(localStorage.getItem("reservas") || "[]")
  };

  const blob = new Blob([JSON.stringify(dados, null, 2)], {type: "application/json"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "backup_sistema.json";
  a.click();

  showToast("Backup gerado com sucesso!", "success");
}

function limparSistema(){
  if (!confirm("Apagar todos os dados exceto dispositivos?")) return;

  // mant√©m somente notebooks
  const notebooks = JSON.parse(localStorage.getItem("notebooks") || "[]");

  // limpa somente as chaves seguras
  const chavesParaLimpar = [
    "alunos",
    "professores",
    "reservas",
    "emprestimos",
    "usuarios",
    "usuarioAtual"
  ];

  chavesParaLimpar.forEach(chave => localStorage.removeItem(chave));

  // restaura notebooks
  localStorage.setItem("notebooks", JSON.stringify(notebooks));

  showToast("Sistema zerado. Dispositivos preservados.", "success");

  // voltar pro login sem quebrar app
  abrirLogin();
  document.getElementById("app").style.display = "none";
}


    function setIndisponivel(id){
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const nb = notebooks.find(n=>n.id === id);
      if (!nb) return showToast('Notebook n√£o encontrado.', 'danger');
      nb.status = 'Indispon√≠vel';
      localStorage.setItem('notebooks', JSON.stringify(notebooks));
      renderConfig(document.getElementById('conteudo'));
      showToast(`Notebook ${id} marcado como indispon√≠vel.`, 'info', 1600);
      atualizarHomeData();
    }

    function setDisponivel(id){
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const nb = notebooks.find(n=>n.id === id);
      if (!nb) return showToast('Notebook n√£o encontrado.', 'danger');
      nb.status = 'Dispon√≠vel';
      localStorage.setItem('notebooks', JSON.stringify(notebooks));
      renderConfig(document.getElementById('conteudo'));
      showToast(`Notebook ${id} marcado como dispon√≠vel.`, 'success', 1400);
      atualizarHomeData();
    }

    function removerNotebook(id){
      if (!confirm(`Remover ${id} do invent√°rio permanentemente?`)) return;
      // also remove it from any reservas and emprestimos
      let notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      notebooks = notebooks.filter(n=>n.id !== id);
      localStorage.setItem('notebooks', JSON.stringify(notebooks));

      let reservas = JSON.parse(localStorage.getItem('reservas')) || [];
      reservas = reservas.map(r => ({...r, notebooks: r.notebooks.filter(x=>x!==id)})).filter(r => r.notebooks.length);
      localStorage.setItem('reservas', JSON.stringify(reservas));

      let emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      emprestimos = emprestimos.filter(e=>e.id !== id);
      localStorage.setItem('emprestimos', JSON.stringify(emprestimos));

      renderConfig(document.getElementById('conteudo'));
      showToast(`Notebook ${id} removido.`, 'success', 1400);
      atualizarHomeData();
    }

    function resetarDisponiveis(){
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      notebooks.forEach(n=>{ if (n.status !== 'Indispon√≠vel') n.status = 'Dispon√≠vel' });
      localStorage.setItem('notebooks', JSON.stringify(notebooks));
      renderConfig(document.getElementById('conteudo'));
      showToast('Todos os dispositivos (n√£o indispon√≠veis) marcados como dispon√≠veis.', 'success', 1600);
      atualizarHomeData();
    }

    function removerIndisponiveis(){
      if (!confirm('Remover TODOS os dispositivos marcados como indispon√≠veis?')) return;
      let notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const idsRemovidos = notebooks.filter(n=> n.status === 'Indispon√≠vel').map(n=>n.id);
      notebooks = notebooks.filter(n=> n.status !== 'Indispon√≠vel');
      localStorage.setItem('notebooks', JSON.stringify(notebooks));

      let reservas = JSON.parse(localStorage.getItem('reservas')) || [];
      reservas = reservas.map(r => ({...r, notebooks: r.notebooks.filter(x=>!idsRemovidos.includes(x))})).filter(r => r.notebooks.length);
      localStorage.setItem('reservas', JSON.stringify(reservas));

      showToast('Indispon√≠veis removidos.', 'success', 1600);
      renderConfig(document.getElementById('conteudo'));
      atualizarHomeData();
    }

    // ---------- Search global (top) ----------
    function onGlobalSearch(){
      const q = document.getElementById('globalSearch').value.trim().toLowerCase();
      if (!q) {
        mostrarPagina('home');
        return;
      }

      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')) || [];
      const notebooks = JSON.parse(localStorage.getItem('notebooks')) || [];
      const alunos = JSON.parse(localStorage.getItem('alunos')) || [];

      if (notebooks.some(n => n.id.toLowerCase().includes(q) || n.marca.toLowerCase().includes(q))) {
        mostrarPagina('notebooks');
        setTimeout(()=> {
          const el = document.getElementById('searchDevice');
          if (el) { el.value = q; renderNotebooks(document.getElementById('conteudo')); }
        }, 80);
        return;
      }

      if (alunos.some(a => a.nome.toLowerCase().includes(q))) {
        mostrarPagina('alunos');
        showToast('Navegue na lista de alunos; termo: "'+q+'".', 'info', 1800);
        return;
      }

      if (emprestimos.some(e => (e.alunoSel + ' ' + e.id + ' ' + e.profSel).toLowerCase().includes(q))) {
        mostrarPagina('emprestimos');
        setTimeout(()=> {
          const se = document.getElementById('searchEmp');
          if (se) { se.value = q; renderEmprestimos(document.getElementById('conteudo')); }
        }, 80);
        return;
      }

      showToast('Nenhum resultado r√°pido. Tente navegar nas p√°ginas.', 'info', 1600);
    }

    // ---------- Reset data ----------
    function resetarDados(){
      if (!confirm('Tem certeza que deseja apagar todos os dados do sistema?')) return;
      localStorage.clear();
      showToast('Dados apagados ‚Äî recarregando...', 'success', 1200);
      setTimeout(()=> location.reload(), 900);
    }

    // ---------- Backup / Export ----------
    function openBackup(){
      const data = {
        notebooks: JSON.parse(localStorage.getItem('notebooks')||'[]'),
        alunos: JSON.parse(localStorage.getItem('alunos')||'[]'),
        professores: JSON.parse(localStorage.getItem('professores')||'[]'),
        emprestimos: JSON.parse(localStorage.getItem('emprestimos')||'[]'),
        reservas: JSON.parse(localStorage.getItem('reservas')||'[]')
      };
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `backup_ccm_notebooks_${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Backup gerado.', 'success');
    }

    function exportCSV(){
      const emprestimos = JSON.parse(localStorage.getItem('emprestimos')||'[]');
      if (!emprestimos.length) return showToast('Sem dados para exportar.', 'danger');
      const headers = ['Notebook','Aluno','Professor','Status','Data'];
      const rows = emprestimos.map(e => [e.id, e.alunoSel, e.profSel, e.status, e.dataDevolucao || e.data || '']);
      const csv = [headers, ...rows].map(r => r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = `relatorio_emprestimos_${new Date().toISOString().slice(0,10)}.csv`; a.click(); URL.revokeObjectURL(url);
      showToast('CSV exportado.', 'success');
    }

    // ---------- RESTAURAR INVENT√ÅRIO ORIGINAL ----------
function restaurarEquipamentosOriginais() {
  const novos = [];

  // 20 Notebooks VAIO
  for (let i = 1; i <= 20; i++) {
    novos.push({ id: `V-${i}`, marca: "VAIO", tipo: "Notebook", status: "Dispon√≠vel" });
  }

  // 35 Tablets Samsung
  for (let i = 1; i <= 35; i++) {
    novos.push({ id: `TS-${i}`, marca: "Samsung", tipo: "Tablet", status: "Dispon√≠vel" });
  }

  // 10 Chromebooks Samsung
  for (let i = 1; i <= 10; i++) {
    novos.push({ id: `CS-${i}`, marca: "Samsung", tipo: "Chromebook", status: "Dispon√≠vel" });
  }

  // 20 Notebooks Positivo
  for (let i = 1; i <= 20; i++) {
    novos.push({ id: `P-${i}`, marca: "Positivo", tipo: "Notebook", status: "Dispon√≠vel" });
  }

  // Salvar no localStorage
  localStorage.setItem("notebooks", JSON.stringify(novos));

  showToast("Invent√°rio original restaurado com sucesso!", "success");

  // Atualiza a p√°gina, se estiver em Configura√ß√µes
  const conteudo = document.getElementById("conteudo");
  if (conteudo && typeof renderConfig === "function") {
    renderConfig(conteudo);
  }
}

function atualizarListaResponsaveis() {
  const tipo = document.getElementById("modalTipo").value;
  const select = document.getElementById("modalNome");

  const alunos = JSON.parse(localStorage.getItem("alunos")) || [];
  const professores = JSON.parse(localStorage.getItem("professores")) || [];

  select.innerHTML = ""; // limpar op√ß√µes

  if (tipo === "aluno") {
    select.innerHTML = `<option value="">Selecione o aluno</option>`;
    alunos.forEach(a => {
      select.innerHTML += `<option value="${a.nome}">${a.nome} (${a.turma})</option>`;
    });
  } else {
    select.innerHTML = `<option value="">Selecione o professor</option>`;
    professores.forEach(p => {
      select.innerHTML += `<option value="${p.nome}">${p.nome}</option>`;
    });
  }
}


  </script>
</body>
</html>
